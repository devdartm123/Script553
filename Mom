local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Aimbot Hub",
    LoadingTitle = "Loading...",
    LoadingSubtitle = "by You",
    ConfigurationSaving = {Enabled = false},
    KeySystem = false
})
local Tab = Window:CreateTab("Main", 4483362458)

local AimbotEnabled = false
local Camera = workspace.CurrentCamera
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local CurrentHighlight = nil

local function GetClosestPlayer()
    local closestPlayer = nil
    local closestDistance = math.huge
    local localPos = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Head") and LocalPlayer.Character.Head.Position

    if not localPos then return nil end

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local head = player.Character.Head
            local distance = (head.Position - localPos).Magnitude
            if distance < closestDistance then
                closestDistance = distance
                closestPlayer = player
            end
        end
    end
    return closestPlayer
end

local function ClearHighlight()
    if CurrentHighlight then
        CurrentHighlight:Destroy()
        CurrentHighlight = nil
    end
end

local Button = Tab:CreateButton({
    Name = "Toggle Aimbot & ESP",
    Callback = function()
        AimbotEnabled = not AimbotEnabled
        Rayfield:Notify({
            Title = "Aimbot & ESP",
            Content = AimbotEnabled and "Enabled" or "Disabled",
            Duration = 2
        })

        if AimbotEnabled then
            spawn(function()
                while AimbotEnabled do
                    local target = GetClosestPlayer()
                    if target and target.Character and target.Character:FindFirstChild("Head") then
                        -- Aimbot: Lock camera to target's head
                        Camera.CFrame = CFrame.new(Camera.CFrame.Position, target.Character.Head.Position)

                        -- ESP: Highlight the target
                        ClearHighlight() -- Remove previous highlight
                        local highlight = Instance.new("Highlight")
                        highlight.Adornee = target.Character
                        highlight.FillColor = Color3.fromRGB(255, 0, 0) -- Red glow
                        highlight.OutlineColor = Color3.fromRGB(255, 255, 255) -- White outline
                        highlight.FillTransparency = 0.5
                        highlight.OutlineTransparency = 0
                        highlight.Parent = target.Character
                        CurrentHighlight = highlight
                    else
                        ClearHighlight() -- Clear if no target
                    end
                    wait()
                end
                ClearHighlight() -- Clean up when disabled
            end)
        else
            ClearHighlight() -- Clear highlight when toggled off
        end
    end,
})
